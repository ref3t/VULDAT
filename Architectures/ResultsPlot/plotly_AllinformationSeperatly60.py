

import matplotlib.pyplot as plt
import pandas as pd

data_just_proc = [
    [1, 0.004310345, 0.008583691],
    [1, 0.010869565, 0.021505376],
    [1, 0.00877193, 0.017391304],
    [0.75, 0.0234375, 0.045454545],
    [0.75, 0.015228426, 0.029850746],
    [0.5, 0.033707865, 0.063157895],
    [0.857142857, 0.018808777, 0.036809816],
    [1, 0.043478261, 0.083333333],
    [1, 0.002777778, 0.005540166],
    [0.238095238, 0.02283105, 0.041666667],
    [0.611111111, 0.051401869, 0.094827586],
    [0.384615385, 0.048543689, 0.086206897],
    [0.8, 0.017391304, 0.034042553],
    [1, 0.019607843, 0.038461538],
    [0.5, 0.008403361, 0.016528926],
    [0.5, 0.013986014, 0.027210884],
    [0.666666667, 0.011494253, 0.02259887],
    [1, 0.017241379, 0.033898305],
    [1, 0.033898305, 0.06557377],
    [1, 0.03125, 0.060606061],
    [1, 0.020833333, 0.040816327],
    [0.6, 0.012931034, 0.025316456],
    [0.642857143, 0.125, 0.209302326],
    [0.285714286, 0.014705882, 0.027972028],
    [1, 0.013888889, 0.02739726],
    [1, 0.008474576, 0.016806723],
    [1, 0.047058824, 0.08988764],
    [1, 0.02, 0.039215686],
    [0.5, 0.01, 0.019607843],
    [0.5, 0.011764706, 0.022988506],
    [1, 0.142857143, 0.25],
    [0.25, 0.006666667, 0.012987013],
    [0.25, 0.033333333, 0.058823529],
    [1, 0.030769231, 0.059701493],
    [1, 0.006944444, 0.013793103],
    [1, 0.006024096, 0.011976048],
    [1, 0.01, 0.01980198],
    [1, 0.015384615, 0.03030303],
    [1, 0.005405405, 0.010752688],
    [1, 0.052631579, 0.1],
    [1, 0.006024096, 0.011976048],
    [0.5, 0.03, 0.056603774],
    [1, 0.030927835, 0.06],
    [0.272727273, 0.024590164, 0.045112782],
    [1, 0.085714286, 0.157894737],
    [1, 0.066666667, 0.125],
    [1, 0.142857143, 0.25],
    [1, 0.023255814, 0.045454545],
    [1, 0.109090909, 0.196721311],
    [0.625, 0.044444444, 0.082987552],
    [0.5, 0.004424779, 0.00877193],
    [0.8, 0.027777778, 0.053691275],
    [1, 0.114285714, 0.205128205],
    [1, 0.059405941, 0.112149533],
    [1, 0.004016064, 0.008],
    [1, 0.004926108, 0.009803922],
    [1, 0.007936508, 0.015748031],
    [1, 0.038461538, 0.074074074],
    [1, 0.023809524, 0.046511628],
    [1, 0.028571429, 0.055555556],
    [0.6, 0.036585366, 0.068965517],
    [0.111111111, 0.142857143, 0.125],
    [1, 0.011029412, 0.021818182],
    [1, 0.023809524, 0.046511628],
    [1, 0.034482759, 0.066666667],
    [1, 0.008196721, 0.016260163],
    [0.5, 0.006024096, 0.011904762],
    [0.4, 0.023529412, 0.044444444],
    [0.5, 0.005235602, 0.010362694],
    [0.333333333, 0.01010101, 0.019607843],
    [1, 0.012244898, 0.024193548],
    [0.571428571, 0.058823529, 0.106666667],
    [1, 0.00862069, 0.017094017],
    [0.166666667, 0.013888889, 0.025641026],
    [1, 0.052631579, 0.1],
    [1, 0.011627907, 0.022988506],
    [1, 0.095238095, 0.173913043],
    [0.666666667, 0.015873016, 0.031007752],
    [1, 0.005181347, 0.010309278],
    [1, 0.011235955, 0.022222222],
    [1, 0.035087719, 0.06779661],
    [0.666666667, 0.015625, 0.030534351],
    [1, 0.028571429, 0.055555556],
    [0.5, 0.012765957, 0.024896266],
    [1, 0.038461538, 0.074074074],
    [1, 0.006944444, 0.013793103],
    [1, 0.024390244, 0.047619048],
    [1, 0.016528926, 0.032520325],
    [0.2, 0.02739726, 0.048192771],
    [1, 0.058823529, 0.111111111],
    [0.75, 0.012987013, 0.025531915],
    [1, 0.019230769, 0.037735849],
    [1, 0.019417476, 0.038095238],
    [1, 0.052631579, 0.1],
    [1, 0.005813953, 0.011560694],
    [1, 0.029411765, 0.057142857],
    [1, 0.016806723, 0.033057851],
    [1, 0.004514673, 0.008988764],
    [1, 0.012195122, 0.024096386],
    [1, 0.010380623, 0.020547945],
    [0.857142857, 0.023904382, 0.046511628],
    [1, 0.029787234, 0.05785124],
    [1, 0.005555556, 0.011049724],
    [1, 0.019354839, 0.037974684],
    [1, 0.012903226, 0.025477707],
    [1, 0.019047619, 0.037383178],
    [0.8, 0.031746032, 0.061068702],
    [0.333333333, 0.010989011, 0.021276596],
    [1, 0.02484472, 0.048484848],
    [1, 0.011904762, 0.023529412],
    [1, 0.010204082, 0.02020202],
    [1, 0.005813953, 0.011560694],
    [1, 0.008474576, 0.016806723],
    [0.2, 0.007936508, 0.015267176],
    [0.5, 0.032258065, 0.060606061]
]


data_techniques_without_sub = [
    # #[0, 0, 0],
    [0.8, 0.0625, 0.115942029],
    [0.666666667, 0.105263158, 0.181818182],
    # #[0, 0, 0],
    [1, 0.285714286, 0.444444444],
    [0.875, 0.368421053, 0.518518519],
    [0.363636364, 0.210526316, 0.266666667],
    [0.1, 0.071428571, 0.083333333],
    [1, 0.261904762, 0.41509434],
    [0.571428571, 0.421052632, 0.484848485],
    [0.125, 1, 0.222222222],
    [0.222222222, 0.105263158, 0.142857143],
    [0.666666667, 0.315789474, 0.428571429],
    [0.888888889, 0.421052632, 0.571428571],
    [0.5, 0.052631579, 0.095238095],
    # #[0, 0, 0],
    [0.5, 0.142857143, 0.222222222],
    [0.818181818, 0.257142857, 0.391304348],
    [1, 0.082352941, 0.152173913],
    [0.625, 0.526315789, 0.571428571],
    # #[0, 0, 0],
    [0.739130435, 0.333333333, 0.459459459],
    [1, 0.58974359, 0.741935484],
    [1, 0.058823529, 0.111111111],
    [1, 0.294117647, 0.454545455],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [1, 0.235294118, 0.380952381],
    [0.818181818, 0.473684211, 0.6],
    [1, 0.176470588, 0.3],
    [1, 0.138888889, 0.243902439],
    # #[0, 0, 0],
    [0.344262295, 0.567567568, 0.428571429],
    [1, 0.481481481, 0.65],
    [0.214285714, 0.176470588, 0.193548387],
    # #[0, 0, 0],
    [1, 0.263157895, 0.416666667],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.763157895, 0.58, 0.659090909],
    [0.84375, 0.692307692, 0.76056338],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.952830189, 0.808, 0.874458874],
    [0.428571429, 0.157894737, 0.230769231],
    [0.04, 0.2, 0.066666667],
    [1, 0.285714286, 0.444444444],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.6875, 0.578947368, 0.628571429],
    [0.727272727, 0.695652174, 0.711111111],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.166666667, 1, 0.285714286],
    [1, 0.052631579, 0.1],
    # #[0, 0, 0]
    ]

data_subtechniques_without_tech =[
    # #[0, 0, 0],
    [0.818181818, 0.642857143, 0.72],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.895833333, 0.781818182, 0.834951456],
    [0.863636364, 0.301587302, 0.447058824],
    [0.931034483, 0.5, 0.65060241],
    [1, 0.166666667, 0.285714286],
    [1, 0.157894737, 0.272727273],
    [0.857142857, 0.857142857, 0.857142857],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.4, 0.285714286, 0.333333333],
    [0.533333333, 0.8, 0.64],
    [0.357142857, 0.625, 0.454545455],
    [0.384615385, 0.555555556, 0.454545455],
    [0.2, 0.105263158, 0.137931034],
    [0.875, 0.5, 0.636363636],
    [1, 0.185185185, 0.3125],
    [0.833333333, 0.714285714, 0.769230769],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.608695652, 0.518518519, 0.56],
    [1, 0.066666667, 0.125],
    [0.166666667, 0.1, 0.125],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.674418605, 0.402777778, 0.504347826],
    # #[0, 0, 0],
    [0.934782609, 0.5375, 0.682539683],
    [0.4375, 1, 0.608695652],
    [0.052631579, 0.25, 0.086956522],
    [1, 0.214285714, 0.352941176],
    [0.25, 0.285714286, 0.266666667],
    [0.545454545, 0.75, 0.631578947],
    [1, 0.360824742, 0.53030303],
    [0.5, 0.428571429, 0.461538462],
    [1, 1, 1],
    [0.8, 1, 0.888888889],
    # #[0, 0, 0],
    [1, 0.509090909, 0.674698795],
    [0.9, 0.272727273, 0.418604651],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
    [0.941176471, 0.727272727, 0.820512821],
    [0.8, 0.52173913, 0.631578947],
    # #[0, 0, 0],
    # #[0, 0, 0],
    # #[0, 0, 0],
]

data_tactic =[
    # #[0, 0, 0],
    [0.333333333, 0.014492754, 0.027777778],
    [0.755555556, 0.126394052, 0.21656051],
    [0.884057971, 0.242063492, 0.380062305],
    [0.9, 0.075630252, 0.139534884],
    # #[0, 0, 0],
    [0.181818182, 0.015748031, 0.028985507],
    # #[0, 0, 0],
    [0.333333333, 0.012048193, 0.023255814],
    [0.25, 0.045454545, 0.076923077],
    [1, 0.147540984, 0.257142857]
]

Capec_data = [
    [0.333333333, 0.025641026, 0.047619048],
    [0.315789474, 0.052631579, 0.090225564],
    [0.0625, 0.018181818, 0.028169014],
    [0.214285714, 0.068181818, 0.103448276],
    [0.428571429, 0.3, 0.352941176],
    [0.076923077, 0.125, 0.095238095],
    [0.714285714, 0.227272727, 0.344827586],
    [0.666666667, 0.030769231, 0.058823529],
    [0.055555556, 1, 0.105263158],
    [0.6, 0.166666667, 0.260869565],
    [1, 0.052631579, 0.1],
    [0.047619048, 0.117647059, 0.06779661],
    [0.1, 0.052631579, 0.068965517],
    [0.714285714, 0.357142857, 0.476190476],
    [0.3, 0.666666667, 0.413793103],
    [1, 0.052631579, 0.1],
    [1, 0.052631579, 0.1],
    [1, 0.052631579, 0.1],
    [0.5, 0.052631579, 0.095238095],
    [1, 0.086956522, 0.16],
    [0.209302326, 0.473684211, 0.290322581],
    [1, 0.105263158, 0.19047619],
    [0.5, 0.052631579, 0.095238095],
    [1, 0.1, 0.181818182],
    [0.538461538, 0.233333333, 0.325581395]
]


import plotly.express as px
import pandas as pd

labels = ["Precision", "Recall", "F1 Score"]
print(len(data_just_proc))
print(len(data_techniques_without_sub))
print(len(data_subtechniques_without_tech))
df1 = pd.DataFrame(data_just_proc, columns=labels)
df3 = pd.DataFrame(data_techniques_without_sub, columns=labels)
df4 = pd.DataFrame(data_subtechniques_without_tech, columns=labels)
# df5 = pd.DataFrame(data_tactic, columns=labels)
df6 = pd.DataFrame(Capec_data, columns=labels)



# combined_df = pd.concat([df1, df3, df4,df5,df6], ignore_index=True)
# combined_df["ATT&CK Information"] =["All Tactics"] * len(df5) + ["All Techniques"] * len(df3) + ["All Sub-Techniques"] * len(df4)+ ["All Procedures"] * len(df1)+ ["All CAPECs"] * len(df6) 
combined_df = pd.concat([ df3,df4,df1,df6], ignore_index=True)
combined_df["ATT&CK Information"] =["All Techniques"] * len(df3)  + ["All Sub-Techniques"] * len(df4)+ ["All Procedures"] * len(df1)+ ["All CAPECs"] * len(df6) 

melted_df = pd.melt(combined_df, id_vars=["ATT&CK Information"], value_vars=labels, var_name="Metric", value_name="Value")

fig = px.box(melted_df, x="Metric", y="Value", color="ATT&CK Information", color_discrete_sequence=["black", "dimgrey", "darkgrey", "slategrey"])
fig.update_layout(
    title="Combined Box Plot for Metrics",
    xaxis_title="Metric",
    yaxis_title="Value",
    plot_bgcolor="white",
    paper_bgcolor="white"
)

# Add x-axis label
fig.update_xaxes(title_text="Metrics")

# Add y-axis label
fig.update_yaxes(title_text="Metric Values")

# Add mean indicator
fig.update_traces(boxmean=True)
fig.show()
